<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Preview Generator</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: white;
            text-align: center;
        }
        canvas {
            border: 2px solid #333;
            border-radius: 10px;
            margin: 20px 0;
        }
        .controls {
            margin: 20px 0;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 10px;
        }
        button:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <h1>Website Preview Generator</h1>
    <canvas id="previewCanvas" width="800" height="400"></canvas>
    
    <div class="controls">
        <button onclick="generatePreview()">Generate Preview</button>
        <button onclick="downloadPNG()">Download PNG</button>
        <button onclick="autoServePNG()">Auto-Serve PNG</button>
    </div>
    
    <div id="info">
        <p>This page generates a PNG preview of your website info.</p>
        <p>Add <code>?png=1</code> to the URL to automatically serve as PNG.</p>
    </div>

    <script>
        const canvas = document.getElementById('previewCanvas');
        const ctx = canvas.getContext('2d');

        function generatePreview() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Create gradient background
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Add glassmorphism card
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.fillRect(150, 100, 500, 200);
            
            // Add border
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 2;
            ctx.strokeRect(150, 100, 500, 200);
            
            // Add text
            ctx.fillStyle = 'white';
            ctx.font = 'bold 36px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ðŸŒ Personal Website', 400, 160);
            
            ctx.font = '20px Arial';
            ctx.fillText('Portfolio & Projects', 400, 190);
            
            // Add URL box
            ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.fillRect(300, 210, 200, 40);
            ctx.strokeRect(300, 210, 200, 40);
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('irusland.github.io', 400, 235);
            
            // Add click hint
            ctx.font = '14px Arial';
            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            ctx.fillText('Click to visit website', 400, 370);
        }

        function downloadPNG() {
            const link = document.createElement('a');
            link.download = 'website-preview.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        function autoServePNG() {
            // Convert canvas to blob and serve as PNG
            canvas.toBlob(function(blob) {
                const url = URL.createObjectURL(blob);
                window.location.href = url; // Redirect in same page instead of popup
            }, 'image/png');
        }

        // Check if PNG should be auto-served
        function checkAutoServe() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('png') === '1') {
                generatePreview();
                setTimeout(() => {
                    // Get PNG data and redirect to data URL
                    canvas.toBlob(function(blob) {
                        const reader = new FileReader();
                        reader.onload = function() {
                            // Redirect to data URL which browsers will display as PNG
                            window.location.href = reader.result;
                        };
                        reader.readAsDataURL(blob);
                    }, 'image/png');
                }, 100);
            }
        }

        // Generate preview on load
        window.onload = function() {
            generatePreview();
            checkAutoServe();
            
            // Auto-click "Auto-Serve PNG" button if ?auto=1 parameter is present
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('auto') === '1') {
                setTimeout(() => {
                    autoServePNG();
                }, 500); // Small delay to ensure canvas is ready
            }
        };

        // Auto-refresh preview every 30 seconds if accessed with ?png=1
        if (new URLSearchParams(window.location.search).get('png') === '1') {
            setInterval(() => {
                generatePreview();
            }, 30000);
        }
    </script>
</body>
</html>